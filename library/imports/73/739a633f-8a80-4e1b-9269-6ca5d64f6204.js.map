{"version":3,"sources":["assets\\gameComon\\sign\\sign.js"],"names":["cc","Class","Component","properties","signNode","Node","closeBtn","signBtn","replenishSignBtn","closeCallback","signCallback","onLoad","reg","regArr","on","EventType","TOUCH_END","onCloseBtnClicked","onClickSignInBtn","onClickReplenishSignBtnInBtn","start","show","opts","config","type","showType","item","signItem","signConfig","backCB","signCB","initData","showUI","bind","cb","days","i","length","isSign","push","singnday","save_data","day","sys","localStorage","getItem","JSON","parse","isConfigChange","isLastDay","isPass","ishadToday","isNextWeek","signType","today","getTodayDay","sign","monthDay","weekIndexInMonth","removeItem","active","getChildByName","y","itemSingle","stringify","getComponent","init","itemId","btn1","icon","underscore","each","value","key","appGame","interstitialAd","playAd","banner","playBanner","appBoxAd","playBox","blockAd","playBlockad","httpUtils","httpPost","consts","HTTP_RECORD_SERVER","title","content","event","desc","currentReplenishSign","isFirstSign","emitter","emit","LOCAL_EVENT_POPUP_LOADTIP","replenishSign","weekDay","getWeekDay","isPlayVideo","isForce","video","force","videoBanner","playVideoAd","isSuc","console","log","setItem","signSuccessTip","isSignToday","dayIndex","tempday","getNextDay","weekIndex","info","iscall","count","gameServerRoom","commonConfig","find","id","name","node","removeFromParent","date","Date","setDate","d","getDate","firstWeekDate","getDay","Math","ceil","index","week","yy","getFullYear","mm","getMonth","dd","todayday","nextday"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        signNode:[cc.Node],\r\n        closeBtn:cc.Node,\r\n        signBtn:cc.Node,\r\n        replenishSignBtn:cc.Node,\r\n        closeCallback:null,\r\n        signCallback:null,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.reg = false;\t\t//是否已经签到\r\n\t\tthis.regArr = [];\r\n        this.closeBtn.on(cc.Node.EventType.TOUCH_END,this.onCloseBtnClicked,this);\r\n        this.signBtn.on(cc.Node.EventType.TOUCH_END,this.onClickSignInBtn,this);\r\n        this.replenishSignBtn.on(cc.Node.EventType.TOUCH_END,this.onClickReplenishSignBtnInBtn,this);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    /**\r\n     * @param opts\r\n     * showType 1 连续性签到  2 累积型签到  3 按照星期签到\r\n     * signItem 签到数据\r\n     */\r\n    show: function (opts) {\r\n        opts = opts || {};\r\n        if(opts.config && opts.config.type){\r\n            this.showType = opts.config.type;\r\n        }\r\n        if(opts.config && opts.config.item){\r\n            this.signItem = opts.config.item;  \r\n        }\r\n        if(opts.config){\r\n            this.signConfig = opts.config;\r\n        }\r\n        if(opts.backCB){\r\n            this.closeCallback = opts.backCB;\r\n        }\r\n        if(opts.signCB){\r\n            this.signCallback = opts.signCB;\r\n        } \r\n        this.initData(function(){\r\n            this.showUI();\r\n        }.bind(this))\r\n    },\r\n\r\n    initData(cb){\r\n        this.days = [];//签到\r\n        if(this.signItem){\r\n            for(let i=0;i<this.signItem.length;i++){\r\n                let isSign = {'sign':0,'day':'',\"signType\":this.showType}\r\n                this.days.push(isSign);\r\n            }\r\n        }\r\n        this.singnday = [];//上次签到时间\r\n        this.save_data = {};\r\n        //cc.sys.localStorage.removeItem('days_sign');\r\n        let day = cc.sys.localStorage.getItem('days_sign');\r\n        if (day){\r\n            this.days = JSON.parse(day);\r\n            if(this.days){\r\n                //如果后台配置有改变  数据要重新记录\r\n                let isConfigChange = false;\r\n                let isLastDay = true;  //是否是最后一天\r\n                let isPass = true;  //是否连续\r\n                let ishadToday = false;  //是否有当天的\r\n                let isNextWeek = false;  //是否下一周\r\n                if(this.days[0] && this.showType !=this.days[0].signType){\r\n                    isConfigChange = true;\r\n                }else{\r\n                    let today = this.getTodayDay();\r\n                    \r\n                    if(this.showType==1){ //连续签到\r\n                        for(let i=0;i<this.days.length;i++){\r\n                            if(this.days[i].day == today){\r\n                                ishadToday = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                        for(let i=0;i<this.days.length;i++){\r\n                            if(this.days[i].sign == 0 && this.days[i].day != today){\r\n                                isPass = false;\r\n                            }\r\n                            if(this.days[i].day == today){\r\n                                break;\r\n                            }\r\n                        }\r\n                    }else if(this.showType==2){ //累积签到\r\n                        for(let i=0;i<this.days.length;i++){\r\n                            if(this.days[i].day == today){\r\n                                isLastDay = false;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }else if(this.showType==3){ //按星期签到\r\n                        let monthDay = this.weekIndexInMonth();\r\n                        for(let i=0;i<this.days.length;i++){\r\n                            if(this.days[i].sign == 1 && this.days[i].day !=monthDay){\r\n                                isNextWeek = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                \r\n                if((this.showType==2 && isLastDay) || (this.showType==1 &&((!isPass)||(!ishadToday)))\r\n                || (this.showType==3 && isNextWeek) ||isConfigChange){\r\n                    cc.sys.localStorage.removeItem('days_sign');\r\n                    this.days.length = 0;\r\n                    for(let i=0;i<this.signItem.length;i++){\r\n                        let isSign = {'sign':0,'day':'',\"signType\":this.showType}\r\n                        this.days.push(isSign);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        cb();\r\n    },\r\n\r\n    showUI() {\r\n        for(let i=0;i<this.signNode.length;i++){\r\n            this.signNode[i].active = false;\r\n            this.signNode[i].getChildByName('item').active = false;\r\n            this.signNode[i].getChildByName('New Sprite').active = false;\r\n            this.signNode[i].getChildByName('ok').active = false;\r\n        }\r\n        for(let i=0;i<this.signItem.length;i++){\r\n            if(this.signItem.length==3){\r\n                this.signNode[i].y = 60;\r\n            }else{\r\n                if(i<3){\r\n                    this.signNode[i].y = 171.521;\r\n                }\r\n            }\r\n            this.signNode[i].active = true;\r\n        }\r\n        for(let i=0;i<this.signItem.length;i++){\r\n            let itemSingle = this.signItem[i];\r\n            if(JSON.stringify(itemSingle)!='{}'){\r\n                this.signNode[i].getChildByName('item').getComponent('item').init(itemSingle.itemId);\r\n                this.signNode[i].getChildByName('item').active = true;\r\n            }else{\r\n                this.signNode[i].getChildByName('New Sprite').active = true;\r\n            }\r\n        }\r\n        if(this.signConfig && this.signConfig.btn1){\r\n            this.replenishSignBtn.active = this.signConfig.btn1.show;\r\n            this.replenishSignBtn.getChildByName('video').active = this.signConfig.btn1.icon;\r\n        }\r\n        \r\n        underscore.each(this.days,function(value, key){\r\n            //console.log(value+\"   \"+key);\r\n            if(value.sign == 1){\r\n                this.signNode[key].getChildByName('ok').active = true;\r\n            }\r\n        }.bind(this));\r\n        if(appGame.interstitialAd){\r\n            appGame.interstitialAd.playAd();\r\n        }\r\n        appGame.banner.playBanner(2);\r\n        appGame.appBoxAd.playBox(true);\r\n        appGame.blockAd.playBlockad(true,4);\r\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'签到',content:'打开签到界面'},function(){\r\n        });\r\n    },\r\n    /*\r\n    *补签点击事件\r\n    */\r\n    onClickReplenishSignBtnInBtn(event){\r\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'签到',content:'补签',desc:'点击'},function(){\r\n        });\r\n        let currentReplenishSign = -1;\r\n        if(this.showType==1 || this.showType==2){\r\n            let isFirstSign = false;\r\n            for(let i=0;i<this.days.length;i++){\r\n                if(this.days[i].sign == 1){\r\n                    isFirstSign = true;\r\n                    break;\r\n                }\r\n            }\r\n            if(!isFirstSign){\r\n                appGame.emitter.emit(consts.LOCAL_EVENT_POPUP_LOADTIP, {\r\n                    content: '当前还未签到，请先签到'\r\n                });\r\n                return;\r\n            }\r\n            let today = this.getTodayDay();\r\n            let replenishSign = [];\r\n            for(let i=0;i<this.days.length;i++){\r\n                if(today == this.days[i].day){\r\n                    break;\r\n                }\r\n                if(this.days[i].sign!=1){\r\n                    replenishSign.push(i);\r\n                }\r\n            }\r\n            if(replenishSign.length>0){\r\n                currentReplenishSign = replenishSign[0];\r\n            }\r\n        }else if(this.showType==3){\r\n            let replenishSign = [];\r\n            for(let i=0;i<this.days.length;i++){\r\n                let weekDay = this.getWeekDay();\r\n                if(i+1 == weekDay){\r\n                    break;\r\n                }\r\n                if(this.days[i].sign == 0){\r\n                    replenishSign.push(i);\r\n                }\r\n            }\r\n            if(replenishSign.length>0){\r\n                currentReplenishSign = replenishSign[0];\r\n            }\r\n        }\r\n        let isPlayVideo = false;\r\n        let isForce = true;\r\n        if(this.signConfig){\r\n            isPlayVideo = this.signConfig.btn1.video;\r\n            isForce = this.signConfig.btn1.force;\r\n        }\r\n        if(isPlayVideo){\r\n            appGame.videoBanner.playVideoAd(4,isForce,function(isSuc){\r\n                console.log(\"看视频成功\")\r\n                if(currentReplenishSign!=-1){\r\n                    if(this.showType==1 || this.showType==2){\r\n                            this.days[currentReplenishSign].sign = 1;\r\n                            this.signNode[currentReplenishSign].getChildByName('ok').active = true;\r\n                            cc.sys.localStorage.setItem(\"days_sign\", JSON.stringify(this.days));\r\n                            this.signSuccessTip(this.signItem[currentReplenishSign],0);\r\n                        }else if(this.showType==3){\r\n                        this.days[currentReplenishSign].day = this.weekIndexInMonth();//本月的第几周\r\n                        this.days[currentReplenishSign].sign = 1;\r\n                        this.signNode[currentReplenishSign].getChildByName('ok').active = true;\r\n                        cc.sys.localStorage.setItem(\"days_sign\", JSON.stringify(this.days));\r\n                        this.signSuccessTip(this.signItem[currentReplenishSign],0);\r\n                    }\r\n                }\r\n            }.bind(this));\r\n        }else{\r\n            if(currentReplenishSign!=-1){\r\n                if(this.showType==1 || this.showType==2){\r\n                        this.days[currentReplenishSign].sign = 1;\r\n                        this.signNode[currentReplenishSign].getChildByName('ok').active = true;\r\n                        cc.sys.localStorage.setItem(\"days_sign\", JSON.stringify(this.days));\r\n                        this.signSuccessTip(this.signItem[currentReplenishSign],0);\r\n                }else if(this.showType==3){\r\n                    this.days[currentReplenishSign].day = this.weekIndexInMonth();//本月的第几周\r\n                    this.days[currentReplenishSign].sign = 1;\r\n                    this.signNode[currentReplenishSign].getChildByName('ok').active = true;\r\n                    cc.sys.localStorage.setItem(\"days_sign\", JSON.stringify(this.days));\r\n                    this.signSuccessTip(this.signItem[currentReplenishSign],0);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    /*\r\n    *签到点击事件\r\n    */\r\n    onClickSignInBtn() {\r\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'签到',content:'普通签到',desc:'点击'},function(){\r\n        });\r\n        if(this.showType==1 || this.showType==2){\r\n            let isFirstSign = false;\r\n            for(let i=0;i<this.days.length;i++){\r\n                if(this.days[i].sign == 1){\r\n                    isFirstSign = true;\r\n                    break;\r\n                }\r\n            }\r\n            if(isFirstSign){//有已签到过的\r\n                let today = this.getTodayDay();\r\n                let isSignToday = false;\r\n                let dayIndex = -1;\r\n                for(let i=0;i<this.days.length;i++){\r\n                    if(today == this.days[i].day){\r\n                        dayIndex = i;\r\n                        if(this.days[i].sign==1){\r\n                            isSignToday = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if(today == this.days[i].day &&this.days[i].sign==1){\r\n                        isSignToday = true;\r\n                        break;\r\n                    }\r\n                }\r\n                if(isSignToday){\r\n                    appGame.emitter.emit(consts.LOCAL_EVENT_POPUP_LOADTIP, {\r\n                        content: '已签到'\r\n                    });\r\n                }else{\r\n                    this.days[dayIndex].sign = 1;\r\n                    this.signNode[dayIndex].getChildByName('ok').active = true;\r\n                    cc.sys.localStorage.setItem(\"days_sign\", JSON.stringify(this.days));\r\n                    this.signSuccessTip(this.signItem[dayIndex],1);\r\n                }\r\n            }else{\r\n                let tempday = '';\r\n                for(let i=0;i<this.days.length;i++){\r\n                    if(i==0){\r\n                        tempday = this.getTodayDay();\r\n                    }else{\r\n                        tempday = this.getNextDay(tempday);\r\n                    }\r\n                    //cc.log(\"tempday===\"+tempday)\r\n                    this.days[i].day = tempday;\r\n                }\r\n                this.days[0].sign = 1;\r\n                this.signNode[0].getChildByName('ok').active = true;\r\n                cc.sys.localStorage.setItem(\"days_sign\", JSON.stringify(this.days));\r\n                this.signSuccessTip(this.signItem[0],1);\r\n            }\r\n        }else if(this.showType==3){\r\n            let isSign = true;\r\n            let weekIndex = -1;\r\n            for(let i=0;i<this.days.length;i++){\r\n                let weekDay = this.getWeekDay();\r\n                if(this.days[i].sign == 0 && i+1 == weekDay){\r\n                    weekIndex = i;\r\n                    isSign = false;\r\n                    break;\r\n                }\r\n            }\r\n            if(!isSign){\r\n                this.days[weekIndex].day = this.weekIndexInMonth();//本月的第几周\r\n                this.days[weekIndex].sign = 1;\r\n                this.signNode[weekIndex].getChildByName('ok').active = true;\r\n                cc.sys.localStorage.setItem(\"days_sign\", JSON.stringify(this.days));\r\n                this.signSuccessTip(this.signItem[weekIndex],1);\r\n            }else{\r\n                //预留接口\r\n                appGame.emitter.emit(consts.LOCAL_EVENT_POPUP_LOADTIP, {\r\n                    content: '已签到'\r\n                });\r\n            }\r\n        }\r\n    },\r\n\r\n    signSuccessTip(info,iscall){\r\n        if(JSON.stringify(info) != \"{}\"){\r\n            //预留接口\r\n            if(iscall){\r\n                this.signCallback && this.signCallback(info.itemId,info.count);\r\n            }\r\n            if(appGame.gameServerRoom.commonConfig && appGame.gameServerRoom.commonConfig.item){\r\n                let item = underscore.find(appGame.gameServerRoom.commonConfig.item,function(value){\r\n                    return value.id == info.itemId;\r\n                }.bind(this));\r\n                if(item){\r\n                    appGame.emitter.emit(consts.LOCAL_EVENT_POPUP_LOADTIP, {\r\n                        content: '已获得'+item.name+'奖励'\r\n                    });\r\n                    httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'签到',content:'获取奖励',desc:item.name},function(){\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    onCloseBtnClicked: function () {\r\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'签到',content:'关闭签到界面'},function(){\r\n        });\r\n        appGame.appBoxAd.playBox(false);\r\n        appGame.blockAd.playBlockad(false);\r\n        appGame.banner.playBanner(3);\r\n        this.closeCallback && this.closeCallback();\r\n        this.node.removeFromParent();\r\n    },\r\n    weekIndexInMonth() {\r\n        //设置时间为本月的1号\r\n        var date = new Date((new Date(this).setDate(1)) || (new Date()).setDate(1));\r\n        //获取今天的日期\r\n        var today = new Date();\r\n        var d = today.getDate();\r\n        var firstWeekDate;\r\n        if (date.getDay() === 0) { // 判断1号是周日\r\n            firstWeekDate = 6;\r\n        } else { // 判断1号是周一至周六之间\r\n            firstWeekDate = date.getDay() - 1;\r\n        }\r\n        return Math.ceil((d + firstWeekDate)/7)\r\n    },\r\n    getWeekDay(){\r\n        let index = -1;  \r\n        let week = new Date().getDay();  \r\n        if (week == 0) {  \r\n            index = 7;  \r\n        }else{\r\n            index = week;\r\n        }\r\n        return index;\r\n    },\r\n    getTodayDay(){\r\n        let d = new Date();\r\n        var yy=d.getFullYear();\r\n        var mm=d.getMonth()+1;\r\n        var dd=d.getDate();\r\n        var todayday=yy+\"-\";\r\n        if (mm<10){todayday+=\"0\"}\r\n        todayday+=mm+\"-\";\r\n        if(dd<10){todayday+=\"0\"}\r\n        todayday+=dd;\r\n        //cc.log(\"todayday==\"+todayday)\r\n        return todayday;\r\n    },\r\n    getNextDay(d){\r\n        d = new Date(d);\r\n        d = +d + 1000*60*60*24;\r\n        d = new Date(d);\r\n\r\n        var yy=d.getFullYear();\r\n        var mm=d.getMonth()+1;\r\n        var dd=d.getDate();\r\n        var nextday=yy+\"-\";\r\n        if (mm<10){nextday+=\"0\"}\r\n        nextday+=mm+\"-\";\r\n        if(dd<10){nextday+=\"0\"}\r\n        nextday+=dd;\r\n        return nextday;\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}