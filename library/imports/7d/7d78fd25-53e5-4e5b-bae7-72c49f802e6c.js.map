{"version":3,"sources":["assets\\Game\\Scripts\\ui\\WinDialog.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { UserInfo, ChoiceType } from \"../Info\";\n\nimport ViewManager from \"../../../framework/plugin_boosts/ui/ViewManager\";\nimport Consts from \"../hex-lines-game/Consts\";\n\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class WinDialog extends cc.Component {\n\n\n    @property(cc.ParticleSystem)\n    ps:cc.ParticleSystem = null;\n\n    @property(cc.Label)\n    levelLabel:cc.Label = null;\n\n    @property(cc.Node)\n    screenShareAuto:cc.Node = null;\n    \n    onLoad () {}\n    start () {}\n    decreaseFomula (max,min,t,d)\n    {\n        return max - (t/ ( t + d) * (max - min) )\n    };\n    onShown()\n    {\n        this.screenShareAuto.active =  false;\n        if(appGame.platform == \"toutiao\"){\n            appGame.screenAuto.playScreenCap(false)\n            this.screenShareAuto.active =  true;\n        }\n        this.ps.resetSystem();\n        \n\n        this.levelLabel.string = cc.js.formatStr(\"关卡 \"+UserInfo.currentLevel)\n\n        let p = this.decreaseFomula(0.99,0.3,UserInfo.timePassed + UserInfo.stepUsed,UserInfo.currentLevel + 50 )\n\n        \n        if(UserInfo.level == UserInfo.currentLevel)\n        {\n            let lv = UserInfo.level\n            let choise = UserInfo.getChoice(ChoiceType.Levelup);\n            // if(choise > 0 && Math.random() > 0.5 && lv >= 3)\n            // {\n            //     this.scheduleOnce(_=>{\n            //         ViewManager.instance.show(\"Game/LevelupDialog\",lv,p)\n            //     },1)\n                \n            // }else{\n               \n            //     p = Math.min(p,1);\n            //     let diamond = Math.floor(Math.max(30 * p,10))\n          \n            //     UserInfo.addDiamond(diamond);\n            // }\n            UserInfo.level = lv + 1\n         \n            UserInfo.save();\n \n        }\n        let choise = UserInfo.getChoice(ChoiceType.HB);\n        if(choise == 1)\n        {\n            if(UserInfo.level >= 3)\n            {\n                if(!UserInfo.isUnlock(Consts.FreeSkinId))\n                {\n                    ViewManager.instance.show(\"Game/HbDialog\")\n                }\n            }\n        }\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'结算界面',content:'第'+UserInfo.level+\"关\"},function(){});\n        appGame.banner.playBanner(1);\n    }\n\n    click_rank()\n    {\n        ViewManager.instance.show(\"wechat/WxRankDialog\")\n    }\n    //修改成开始当前游戏\n    click_shop()\n    {\n        cc.director.loadScene(\"Game\")\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'结算界面',content:'点击重玩'},function(){});\n        if(appGame.gameServerRoom.gameConfigData &&appGame.gameServerRoom.gameConfigData.winAgain){\n            appGame.videoBanner.playVideoAd(3,0,function(){\n              //  UserInfo.currentLevel = UserInfo.currentLevel ;\n               \n            })\n        }\n\n        //ViewManager.instance.show(\"Game/ShopDialog\");\n    }\n\n    click_next()\n    {\n        var btn3 = this.node.getChildByName(\"btn3\").getComponent(cc.Button);\n        btn3.enabled = false;\n        this.scheduleOnce(function(){\n            btn3.enabled = true;\n        }.bind(this),2);\n        UserInfo.currentLevel = UserInfo.currentLevel +1;\n        cc.director.loadScene(\"Game\")\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'结算界面',content:'点击下一关'},function(){});\n        if(appGame.gameServerRoom.gameConfigData &&appGame.gameServerRoom.gameConfigData.winNextLevel){\n            appGame.videoBanner.playVideoAd(2,0,function(){\n                cc.log(\"win1\");\n                btn3.enabled = true;\n            }.bind(this))\n        }\n      \n    }\n\n    click_home()\n    {\n        cc.director.loadScene(\"Main\")\n    }\n\n    click_share()\n    {\n\n    }\n}"]}