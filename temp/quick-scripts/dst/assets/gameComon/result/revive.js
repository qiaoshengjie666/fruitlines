
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/gameComon/result/revive.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'ec134IHnxVI363+v185uOut', 'revive');
// gameComon/result/revive.js

"use strict";

var backBtnTimeOut;
var continueBtnTimeOut;
var countDownInterval;
cc.Class({
  "extends": cc.Component,
  properties: {
    reviveBtn: cc.Button,
    backBtn: cc.Button,
    clock: cc.Node,
    reviveBtnCallback: null,
    backBtnCallback: null
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {
    this.reviveBtn.node.on(cc.Node.EventType.TOUCH_END, this.onReviveBtnClicked, this);
    this.backBtn.node.on(cc.Node.EventType.TOUCH_END, this.onBackBtnClicked, this);
  },
  start: function start() {},

  /**
   * @param opts
   * backCB 放弃按钮回调
   * reviveCB 复活按钮回调
   */
  show: function show(opts) {
    opts = opts || {};

    if (opts.reviveCB) {
      this.reviveBtnCallback = opts.reviveCB;
    }

    if (opts.backCB) {
      this.backBtnCallback = opts.backCB;
    }

    if (opts.config) {
      this.reviveConfig = opts.config;
    }

    this.refreshUI();
  },
  refreshUI: function refreshUI() {
    this._count = 0;
    this.clock.getComponent(cc.ProgressBar).progress = 1;

    if (this.reviveConfig.countdown) {
      this.updateTime(1, this.reviveConfig.countdown, this.reviveConfig.countdown);
    }

    if (this.reviveConfig.btn1) {
      this.reviveBtn.node.getChildByName('Background').getChildByName('New Label').getComponent(cc.Label).string = this.reviveConfig.btn1.name;
      this.reviveBtn.node.getChildByName('Background').getChildByName('icon').active = this.reviveConfig.btn1.icon;
      clearTimeout(continueBtnTimeOut);

      if (this.reviveConfig.btn1.delayTime >= 0) {
        continueBtnTimeOut = setTimeout(function () {
          this.reviveBtn.node.active = true;
        }.bind(this), this.reviveConfig.btn1.delayTime * 1000);
      }
    }

    if (this.reviveConfig.btn2) {
      this.backBtn.node.getChildByName('Background').getChildByName('New Label').getComponent(cc.Label).string = this.reviveConfig.btn2.name;
      this.backBtn.node.getChildByName('Background').getChildByName('icon').active = this.reviveConfig.btn2.icon;
      this.backBtn.node.active = false;
      clearTimeout(backBtnTimeOut);

      if (this.reviveConfig.btn2.delayTime >= 0) {
        backBtnTimeOut = setTimeout(function () {
          this.backBtn.node.active = true;
        }.bind(this), this.reviveConfig.btn2.delayTime * 1000);
      }
    }

    if (appGame.interstitialAd) {
      appGame.interstitialAd.playAd();
    }

    appGame.banner.playBanner(2);
    appGame.appBoxAd.playBox(true);
    appGame.blockAd.playBlockad(true, 4);
    httpUtils.httpPost(consts.HTTP_RECORD_SERVER, {
      title: '复活',
      content: '打开复活界面'
    }, function () {});
  },
  onReviveBtnClicked: function onReviveBtnClicked(event) {
    httpUtils.httpPost(consts.HTTP_RECORD_SERVER, {
      title: '复活',
      content: '复活',
      desc: '点击'
    }, function () {});
    var isPlayVideo = false;
    var isForce = true;

    if (this.reviveConfig) {
      isPlayVideo = this.reviveConfig.btn1.video;
      isForce = this.reviveConfig.btn1.force;
    }

    if (isPlayVideo) {
      appGame.videoBanner.playVideoAd(2, isForce, function (isSuc) {
        console.log("看视频成功");
        this.reviveBtnCallback && this.reviveBtnCallback();
        this.hide();
      }.bind(this));
    } else {
      this.reviveBtnCallback && this.reviveBtnCallback();
      this.hide();
    }
  },
  onBackBtnClicked: function onBackBtnClicked(event) {
    httpUtils.httpPost(consts.HTTP_RECORD_SERVER, {
      title: '复活',
      content: '返回',
      desc: '点击'
    }, function () {});
    var isPlayVideo = false;
    var isForce = true;

    if (this.reviveConfig) {
      isPlayVideo = this.reviveConfig.btn2.video;
      isForce = this.reviveConfig.btn2.force;
    }

    if (isPlayVideo) {
      //配置需要播放视频
      appGame.videoBanner.playVideoAd(2, isForce, function (isSuc) {
        console.log("看视频成功");
        this.backBtnCallback && this.backBtnCallback();
        this.hide();
      }.bind(this));
    } else {
      //不用播放视频
      this.backBtnCallback && this.backBtnCallback();
      this.hide();
    }
  },
  updateTime: function updateTime(type, count, totalcount) {
    if (type == 1) {
      //开始倒计时
      count = count * 1000;
      totalcount = totalcount * 1000;
      var durationtime = 100;
      this._count = count;

      if (this.clock) {
        this.clock.getComponent(cc.ProgressBar).progress = this._count / totalcount;
      }

      clearInterval(countDownInterval);
      countDownInterval = setInterval(function () {
        if (this._count > durationtime) {
          this._count -= durationtime;
        } else {
          this._count = 0;
          clearInterval(countDownInterval);
          this.backBtnCallback && this.backBtnCallback();
          this.hide();
        }

        if (this.clock) {
          this.clock.getComponent(cc.ProgressBar).progress = this._count / totalcount;
        }
      }.bind(this), durationtime);
    } else {
      //关闭倒计时
      clearInterval(countDownInterval);
    }
  },
  hide: function hide() {
    httpUtils.httpPost(consts.HTTP_RECORD_SERVER, {
      title: '复活',
      content: '关闭复活界面'
    }, function () {});
    appGame.banner.playBanner(3);
    appGame.appBoxAd.playBox(false);
    appGame.blockAd.playBlockad(false);
    clearInterval(countDownInterval);
    clearTimeout(backBtnTimeOut);
    clearTimeout(continueBtnTimeOut);
    this.node.removeFromParent();
  } // update (dt) {},

});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZUNvbW9uXFxyZXN1bHRcXHJldml2ZS5qcyJdLCJuYW1lcyI6WyJiYWNrQnRuVGltZU91dCIsImNvbnRpbnVlQnRuVGltZU91dCIsImNvdW50RG93bkludGVydmFsIiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJyZXZpdmVCdG4iLCJCdXR0b24iLCJiYWNrQnRuIiwiY2xvY2siLCJOb2RlIiwicmV2aXZlQnRuQ2FsbGJhY2siLCJiYWNrQnRuQ2FsbGJhY2siLCJvbkxvYWQiLCJub2RlIiwib24iLCJFdmVudFR5cGUiLCJUT1VDSF9FTkQiLCJvblJldml2ZUJ0bkNsaWNrZWQiLCJvbkJhY2tCdG5DbGlja2VkIiwic3RhcnQiLCJzaG93Iiwib3B0cyIsInJldml2ZUNCIiwiYmFja0NCIiwiY29uZmlnIiwicmV2aXZlQ29uZmlnIiwicmVmcmVzaFVJIiwiX2NvdW50IiwiZ2V0Q29tcG9uZW50IiwiUHJvZ3Jlc3NCYXIiLCJwcm9ncmVzcyIsImNvdW50ZG93biIsInVwZGF0ZVRpbWUiLCJidG4xIiwiZ2V0Q2hpbGRCeU5hbWUiLCJMYWJlbCIsInN0cmluZyIsIm5hbWUiLCJhY3RpdmUiLCJpY29uIiwiY2xlYXJUaW1lb3V0IiwiZGVsYXlUaW1lIiwic2V0VGltZW91dCIsImJpbmQiLCJidG4yIiwiYXBwR2FtZSIsImludGVyc3RpdGlhbEFkIiwicGxheUFkIiwiYmFubmVyIiwicGxheUJhbm5lciIsImFwcEJveEFkIiwicGxheUJveCIsImJsb2NrQWQiLCJwbGF5QmxvY2thZCIsImh0dHBVdGlscyIsImh0dHBQb3N0IiwiY29uc3RzIiwiSFRUUF9SRUNPUkRfU0VSVkVSIiwidGl0bGUiLCJjb250ZW50IiwiZXZlbnQiLCJkZXNjIiwiaXNQbGF5VmlkZW8iLCJpc0ZvcmNlIiwidmlkZW8iLCJmb3JjZSIsInZpZGVvQmFubmVyIiwicGxheVZpZGVvQWQiLCJpc1N1YyIsImNvbnNvbGUiLCJsb2ciLCJoaWRlIiwidHlwZSIsImNvdW50IiwidG90YWxjb3VudCIsImR1cmF0aW9udGltZSIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInJlbW92ZUZyb21QYXJlbnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsY0FBSjtBQUNBLElBQUlDLGtCQUFKO0FBQ0EsSUFBSUMsaUJBQUo7QUFDQUMsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLFNBQVMsRUFBQ0osRUFBRSxDQUFDSyxNQURMO0FBRVJDLElBQUFBLE9BQU8sRUFBQ04sRUFBRSxDQUFDSyxNQUZIO0FBR1JFLElBQUFBLEtBQUssRUFBQ1AsRUFBRSxDQUFDUSxJQUhEO0FBSVJDLElBQUFBLGlCQUFpQixFQUFFLElBSlg7QUFLUkMsSUFBQUEsZUFBZSxFQUFFO0FBTFQsR0FIUDtBQVdMO0FBRUFDLEVBQUFBLE1BYkssb0JBYUs7QUFDTixTQUFLUCxTQUFMLENBQWVRLElBQWYsQ0FBb0JDLEVBQXBCLENBQXVCYixFQUFFLENBQUNRLElBQUgsQ0FBUU0sU0FBUixDQUFrQkMsU0FBekMsRUFBbUQsS0FBS0Msa0JBQXhELEVBQTJFLElBQTNFO0FBQ0EsU0FBS1YsT0FBTCxDQUFhTSxJQUFiLENBQWtCQyxFQUFsQixDQUFxQmIsRUFBRSxDQUFDUSxJQUFILENBQVFNLFNBQVIsQ0FBa0JDLFNBQXZDLEVBQWlELEtBQUtFLGdCQUF0RCxFQUF1RSxJQUF2RTtBQUNILEdBaEJJO0FBa0JMQyxFQUFBQSxLQWxCSyxtQkFrQkksQ0FFUixDQXBCSTs7QUFxQkw7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNLQyxFQUFBQSxJQUFJLEVBQUUsY0FBVUMsSUFBVixFQUFnQjtBQUNuQkEsSUFBQUEsSUFBSSxHQUFHQSxJQUFJLElBQUksRUFBZjs7QUFDQSxRQUFHQSxJQUFJLENBQUNDLFFBQVIsRUFBaUI7QUFDYixXQUFLWixpQkFBTCxHQUF5QlcsSUFB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QUFMLENBQVdvQixZQUFYLENBQXdCM0IsRUFBRSxDQUFDNEIsV0FBM0IsRUFBd0NDLFFBQXhDLEdBQW1ELEtBQUtILE1BQUwsR0FBWStDLFVBQS9EO0FBQ0g7QUFDSixPQVorQixDQVk5Qi9CLElBWjhCLENBWXpCLElBWnlCLENBQUQsRUFZakJnQyxZQVppQixDQUEvQjtBQWFILEtBdEJELE1Bc0JLO0FBQUM7QUFDRkMsTUFBQUEsYUFBYSxDQUFDNUUsaUJBQUQsQ0FBYjtBQUNIO0FBQ0osR0FuSkk7QUFxSkx1RSxFQUFBQSxJQXJKSyxrQkFxSkM7QUFDRmpCLElBQUFBLFNBQVMsQ0FBQ0MsUUFBVixDQUFtQkMsTUFBTSxDQUFDQyxrQkFBMUIsRUFBNkM7QUFBQ0MsTUFBQUEsS0FBSyxFQUFDLElBQVA7QUFBWUMsTUFBQUEsT0FBTyxFQUFDO0FBQXBCLEtBQTdDLEVBQTJFLFlBQVUsQ0FDcEYsQ0FERDtBQUVBZCxJQUFBQSxPQUFPLENBQUNHLE1BQVIsQ0FBZUMsVUFBZixDQUEwQixDQUExQjtBQUNBSixJQUFBQSxPQUFPLENBQUNLLFFBQVIsQ0FBaUJDLE9BQWpCLENBQXlCLEtBQXpCO0FBQ0FOLElBQUFBLE9BQU8sQ0FBQ08sT0FBUixDQUFnQkMsV0FBaEIsQ0FBNEIsS0FBNUI7QUFDQXVCLElBQUFBLGFBQWEsQ0FBQzVFLGlCQUFELENBQWI7QUFDQXdDLElBQUFBLFlBQVksQ0FBQzFDLGNBQUQsQ0FBWjtBQUNBMEMsSUFBQUEsWUFBWSxDQUFDekMsa0JBQUQsQ0FBWjtBQUNBLFNBQUtjLElBQUwsQ0FBVWlFLGdCQUFWO0FBQ0gsR0EvSkksQ0FpS0w7O0FBaktLLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBiYWNrQnRuVGltZU91dDtcclxudmFyIGNvbnRpbnVlQnRuVGltZU91dDtcclxudmFyIGNvdW50RG93bkludGVydmFsO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHJldml2ZUJ0bjpjYy5CdXR0b24sXHJcbiAgICAgICAgYmFja0J0bjpjYy5CdXR0b24sXHJcbiAgICAgICAgY2xvY2s6Y2MuTm9kZSxcclxuICAgICAgICByZXZpdmVCdG5DYWxsYmFjazogbnVsbCxcclxuICAgICAgICBiYWNrQnRuQ2FsbGJhY2s6IG51bGxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTElGRS1DWUNMRSBDQUxMQkFDS1M6XHJcblxyXG4gICAgb25Mb2FkICgpIHtcclxuICAgICAgICB0aGlzLnJldml2ZUJ0bi5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCx0aGlzLm9uUmV2aXZlQnRuQ2xpY2tlZCx0aGlzKTtcclxuICAgICAgICB0aGlzLmJhY2tCdG4ubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsdGhpcy5vbkJhY2tCdG5DbGlja2VkLHRoaXMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBzdGFydCAoKSB7XHJcblxyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIG9wdHNcclxuICAgICAqIGJhY2tDQiDmlL7lvIPmjInpkq7lm57osINcclxuICAgICAqIHJldml2ZUNCIOWkjea0u+aMiemSruWbnuiwg1xyXG4gICAgICovXHJcbiAgICAgc2hvdzogZnVuY3Rpb24gKG9wdHMpIHtcclxuICAgICAgICBvcHRzID0gb3B0cyB8fCB7fTtcclxuICAgICAgICBpZihvcHRzLnJldml2ZUNCKXtcclxuICAgICAgICAgICAgdGhpcy5yZXZpdmVCdG5DYWxsYmFjayA9IG9wdHMucmV2aXZlQ0I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKG9wdHMuYmFja0NCKXtcclxuICAgICAgICAgICAgdGhpcy5iYWNrQnRuQ2FsbGJhY2sgPSBvcHRzLmJhY2tDQjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYob3B0cy5jb25maWcpe1xyXG4gICAgICAgICAgICB0aGlzLnJldml2ZUNvbmZpZyA9IG9wdHMuY29uZmlnO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlZnJlc2hVSSgpO1xyXG4gICAgfSxcclxuICAgIHJlZnJlc2hVSSgpe1xyXG4gICAgICAgIHRoaXMuX2NvdW50ID0gMDtcclxuICAgICAgICB0aGlzLmNsb2NrLmdldENvbXBvbmVudChjYy5Qcm9ncmVzc0JhcikucHJvZ3Jlc3MgPSAxO1xyXG4gICAgICAgIGlmKHRoaXMucmV2aXZlQ29uZmlnLmNvdW50ZG93bil7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGltZSgxLHRoaXMucmV2aXZlQ29uZmlnLmNvdW50ZG93bix0aGlzLnJldml2ZUNvbmZpZy5jb3VudGRvd24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZih0aGlzLnJldml2ZUNvbmZpZy5idG4xKXtcclxuICAgICAgICAgICAgdGhpcy5yZXZpdmVCdG4ubm9kZS5nZXRDaGlsZEJ5TmFtZSgnQmFja2dyb3VuZCcpLmdldENoaWxkQnlOYW1lKCdOZXcgTGFiZWwnKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHRoaXMucmV2aXZlQ29uZmlnLmJ0bjEubmFtZTtcclxuICAgICAgICAgICAgdGhpcy5yZXZpdmVCdG4ubm9kZS5nZXRDaGlsZEJ5TmFtZSgnQmFja2dyb3VuZCcpLmdldENoaWxkQnlOYW1lKCdpY29uJykuYWN0aXZlID0gdGhpcy5yZXZpdmVDb25maWcuYnRuMS5pY29uO1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoY29udGludWVCdG5UaW1lT3V0KTtcclxuICAgICAgICAgICAgaWYodGhpcy5yZXZpdmVDb25maWcuYnRuMS5kZWxheVRpbWU+PTApe1xyXG4gICAgICAgICAgICAgICAgY29udGludWVCdG5UaW1lT3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmV2aXZlQnRuLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSx0aGlzLnJldml2ZUNvbmZpZy5idG4xLmRlbGF5VGltZSoxMDAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYodGhpcy5yZXZpdmVDb25maWcuYnRuMil7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja0J0bi5ub2RlLmdldENoaWxkQnlOYW1lKCdCYWNrZ3JvdW5kJykuZ2V0Q2hpbGRCeU5hbWUoJ05ldyBMYWJlbCcpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGhpcy5yZXZpdmVDb25maWcuYnRuMi5uYW1lO1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tCdG4ubm9kZS5nZXRDaGlsZEJ5TmFtZSgnQmFja2dyb3VuZCcpLmdldENoaWxkQnlOYW1lKCdpY29uJykuYWN0aXZlID0gdGhpcy5yZXZpdmVDb25maWcuYnRuMi5pY29uO1xyXG4gICAgICAgICAgICB0aGlzLmJhY2tCdG4ubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGJhY2tCdG5UaW1lT3V0KTtcclxuICAgICAgICAgICAgaWYodGhpcy5yZXZpdmVDb25maWcuYnRuMi5kZWxheVRpbWU+PTApe1xyXG4gICAgICAgICAgICBiYWNrQnRuVGltZU91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJhY2tCdG4ubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLHRoaXMucmV2aXZlQ29uZmlnLmJ0bjIuZGVsYXlUaW1lKjEwMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKGFwcEdhbWUuaW50ZXJzdGl0aWFsQWQpe1xyXG4gICAgICAgICAgICBhcHBHYW1lLmludGVyc3RpdGlhbEFkLnBsYXlBZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhcHBHYW1lLmJhbm5lci5wbGF5QmFubmVyKDIpO1xyXG4gICAgICAgIGFwcEdhbWUuYXBwQm94QWQucGxheUJveCh0cnVlKTtcclxuICAgICAgICBhcHBHYW1lLmJsb2NrQWQucGxheUJsb2NrYWQodHJ1ZSw0KTtcclxuICAgICAgICBodHRwVXRpbHMuaHR0cFBvc3QoY29uc3RzLkhUVFBfUkVDT1JEX1NFUlZFUix7dGl0bGU6J+Wkjea0uycsY29udGVudDon5omT5byA5aSN5rS755WM6Z2iJ30sZnVuY3Rpb24oKXtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgb25SZXZpdmVCdG5DbGlja2VkKGV2ZW50KXtcclxuICAgICAgICBodHRwVXRpbHMuaHR0cFBvc3QoY29uc3RzLkhUVFBfUkVDT1JEX1NFUlZFUix7dGl0bGU6J+Wkjea0uycsY29udGVudDon5aSN5rS7JyxkZXNjOifngrnlh7snfSxmdW5jdGlvbigpe1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxldCBpc1BsYXlWaWRlbyA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBpc0ZvcmNlID0gdHJ1ZTtcclxuICAgICAgICBpZih0aGlzLnJldml2ZUNvbmZpZyl7XHJcbiAgICAgICAgICAgIGlzUGxheVZpZGVvID0gdGhpcy5yZXZpdmVDb25maWcuYnRuMS52aWRlbztcclxuICAgICAgICAgICAgaXNGb3JjZSA9IHRoaXMucmV2aXZlQ29uZmlnLmJ0bjEuZm9yY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGlzUGxheVZpZGVvKXtcclxuICAgICAgICAgICAgYXBwR2FtZS52aWRlb0Jhbm5lci5wbGF5VmlkZW9BZCgyLGlzRm9yY2UsZnVuY3Rpb24oaXNTdWMpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCLnnIvop4bpopHmiJDlip9cIilcclxuICAgICAgICAgICAgICAgIHRoaXMucmV2aXZlQnRuQ2FsbGJhY2sgJiYgdGhpcy5yZXZpdmVCdG5DYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMucmV2aXZlQnRuQ2FsbGJhY2sgJiYgdGhpcy5yZXZpdmVCdG5DYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9LFxyXG5cclxuICAgIG9uQmFja0J0bkNsaWNrZWQoZXZlbnQpe1xyXG4gICAgICAgIGh0dHBVdGlscy5odHRwUG9zdChjb25zdHMuSFRUUF9SRUNPUkRfU0VSVkVSLHt0aXRsZTon5aSN5rS7Jyxjb250ZW50Oifov5Tlm54nLGRlc2M6J+eCueWHuyd9LGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbGV0IGlzUGxheVZpZGVvID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGlzRm9yY2UgPSB0cnVlO1xyXG4gICAgICAgIGlmKHRoaXMucmV2aXZlQ29uZmlnKXtcclxuICAgICAgICAgICAgaXNQbGF5VmlkZW8gPSB0aGlzLnJldml2ZUNvbmZpZy5idG4yLnZpZGVvO1xyXG4gICAgICAgICAgICBpc0ZvcmNlID0gdGhpcy5yZXZpdmVDb25maWcuYnRuMi5mb3JjZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoaXNQbGF5VmlkZW8pey8v6YWN572u6ZyA6KaB5pKt5pS+6KeG6aKRXHJcbiAgICAgICAgICAgIGFwcEdhbWUudmlkZW9CYW5uZXIucGxheVZpZGVvQWQoMixpc0ZvcmNlLGZ1bmN0aW9uKGlzU3VjKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi55yL6KeG6aKR5oiQ5YqfXCIpXHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhY2tCdG5DYWxsYmFjayAmJiB0aGlzLmJhY2tCdG5DYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfWVsc2V7Ly/kuI3nlKjmkq3mlL7op4bpopFcclxuICAgICAgICAgICAgdGhpcy5iYWNrQnRuQ2FsbGJhY2sgJiYgdGhpcy5iYWNrQnRuQ2FsbGJhY2soKTtcclxuICAgICAgICAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVUaW1lKHR5cGUsY291bnQsdG90YWxjb3VudCl7XHJcbiAgICAgICAgaWYodHlwZT09MSl7Ly/lvIDlp4vlgJLorqHml7ZcclxuICAgICAgICAgICAgY291bnQgPSBjb3VudCoxMDAwO1xyXG4gICAgICAgICAgICB0b3RhbGNvdW50ID0gdG90YWxjb3VudCoxMDAwO1xyXG4gICAgICAgICAgICBsZXQgZHVyYXRpb250aW1lID0gMTAwO1xyXG4gICAgICAgICAgICB0aGlzLl9jb3VudCA9IGNvdW50O1xyXG4gICAgICAgICAgICBpZih0aGlzLmNsb2NrKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvY2suZ2V0Q29tcG9uZW50KGNjLlByb2dyZXNzQmFyKS5wcm9ncmVzcyA9IHRoaXMuX2NvdW50L3RvdGFsY291bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChjb3VudERvd25JbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIGNvdW50RG93bkludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLl9jb3VudD5kdXJhdGlvbnRpbWUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvdW50LT1kdXJhdGlvbnRpbWU7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3VudCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChjb3VudERvd25JbnRlcnZhbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYWNrQnRuQ2FsbGJhY2sgJiYgdGhpcy5iYWNrQnRuQ2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuY2xvY2spe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvY2suZ2V0Q29tcG9uZW50KGNjLlByb2dyZXNzQmFyKS5wcm9ncmVzcyA9IHRoaXMuX2NvdW50L3RvdGFsY291bnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSwgZHVyYXRpb250aW1lKTtcclxuICAgICAgICB9ZWxzZXsvL+WFs+mXreWAkuiuoeaXtlxyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKGNvdW50RG93bkludGVydmFsKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGhpZGUoKXtcclxuICAgICAgICBodHRwVXRpbHMuaHR0cFBvc3QoY29uc3RzLkhUVFBfUkVDT1JEX1NFUlZFUix7dGl0bGU6J+Wkjea0uycsY29udGVudDon5YWz6Zet5aSN5rS755WM6Z2iJ30sZnVuY3Rpb24oKXtcclxuICAgICAgICB9KTtcclxuICAgICAgICBhcHBHYW1lLmJhbm5lci5wbGF5QmFubmVyKDMpO1xyXG4gICAgICAgIGFwcEdhbWUuYXBwQm94QWQucGxheUJveChmYWxzZSk7XHJcbiAgICAgICAgYXBwR2FtZS5ibG9ja0FkLnBsYXlCbG9ja2FkKGZhbHNlKTtcclxuICAgICAgICBjbGVhckludGVydmFsKGNvdW50RG93bkludGVydmFsKTtcclxuICAgICAgICBjbGVhclRpbWVvdXQoYmFja0J0blRpbWVPdXQpO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChjb250aW51ZUJ0blRpbWVPdXQpO1xyXG4gICAgICAgIHRoaXMubm9kZS5yZW1vdmVGcm9tUGFyZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdXBkYXRlIChkdCkge30sXHJcbn0pO1xyXG4iXX0=