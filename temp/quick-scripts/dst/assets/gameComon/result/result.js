
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/gameComon/result/result.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '33fa5PoD/RJD6LgBnT5ywP1', 'result');
// gameComon/result/result.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    title: cc.Label,
    contentLabel: cc.Label,
    nextBtn: cc.Button,
    backBtn: cc.Button,
    nextBtnCallback: null,
    backBtnCallback: null
  },
  // LIFE-CYCLE CALLBACKS:
  onLoad: function onLoad() {
    this.nextBtn.node.on(cc.Node.EventType.TOUCH_END, this.onNextBtnClicked, this);
    this.backBtn.node.on(cc.Node.EventType.TOUCH_END, this.onBackBtnClicked, this);
  },
  start: function start() {},

  /**
   * @param opts
   * nextCB 下一局按钮回调
   * backCB 重玩本关按钮回调
   */
  show: function show(opts) {
    opts = opts || {};

    if (opts.nextCB) {
      this.nextBtnCallback = opts.nextCB;
    }

    if (opts.backCB) {
      this.backBtnCallback = opts.backCB;
    }

    if (opts.info) {
      this.info = opts.info;
    }

    if (opts.config) {
      if (this.info.isWin) {
        this.resultConfig = opts.config.win;
      } else {
        this.resultConfig = opts.config.fail;
      }
    }

    this.refreshUI();
  },
  refreshUI: function refreshUI() {
    if (this.info) {
      this.title.string = this.info.isWin ? this.resultConfig.title : this.resultConfig.title;
      this.contentLabel.string = this.info.isWin ? this.resultConfig.content : this.resultConfig.content;
      this.nextBtn.node.getChildByName('Background').getChildByName('New Label').getComponent(cc.Label).string = this.resultConfig.btn1.name;
      this.backBtn.node.getChildByName('Background').getChildByName('New Label').getComponent(cc.Label).string = this.resultConfig.btn2.name;
      this.nextBtn.node.getChildByName('Background').getChildByName('icon').active = this.resultConfig.btn1.icon;
      this.backBtn.node.getChildByName('Background').getChildByName('icon').active = this.resultConfig.btn2.icon;
    }

    if (appGame.interstitialAd) {
      appGame.interstitialAd.playAd();
    }

    appGame.banner.playBanner(2);
    appGame.gridAd.playGridAd(true);
    appGame.nativeAd.playNativeAd(true);
    appGame.appBoxAd.playBox(true);
    appGame.blockAd.playBlockad(true, 4);
    httpUtils.httpPost(consts.HTTP_RECORD_SERVER, {
      title: '结算',
      content: '打开结算界面'
    }, function () {});
  },
  onNextBtnClicked: function onNextBtnClicked(event) {
    httpUtils.httpPost(consts.HTTP_RECORD_SERVER, {
      title: '结算',
      content: '下一关',
      desc: '点击'
    }, function () {});
    var isPlayVideo = false;
    var isForce = true;

    if (this.resultConfig) {
      isPlayVideo = this.resultConfig.btn1.video;
      isForce = this.resultConfig.btn1.force;
    }

    if (isPlayVideo) {
      appGame.videoBanner.playVideoAd(3, isForce, function (isSuc) {
        this.nextBtnCallback && this.nextBtnCallback(this.info.isWin);
        this.hide();
      }.bind(this));
    } else {
      this.nextBtnCallback && this.nextBtnCallback(this.info.isWin);
      this.hide();
    }
  },
  onBackBtnClicked: function onBackBtnClicked(event) {
    httpUtils.httpPost(consts.HTTP_RECORD_SERVER, {
      title: '结算',
      content: '再来一局+点击'
    }, function () {});
    var isPlayVideo = false;
    var isForce = true;

    if (this.resultConfig) {
      isPlayVideo = this.resultConfig.btn2.video;
      isForce = this.resultConfig.btn2.force;
    }

    if (isPlayVideo) {
      //配置需要播放视频
      appGame.videoBanner.playVideoAd(3, isForce, function (isSuc) {
        console.log("看视频成功");
        this.backBtnCallback && this.backBtnCallback(this.info.isWin);
        this.hide();
      }.bind(this));
    } else {
      //不用播放视频
      this.backBtnCallback && this.backBtnCallback(this.info.isWin);
      this.hide();
    }
  },
  hide: function hide() {
    httpUtils.httpPost(consts.HTTP_RECORD_SERVER, {
      title: '结算',
      content: '关闭结算界面'
    }, function () {});
    appGame.banner.playBanner(3);
    appGame.gridAd.playGridAd(false);
    appGame.nativeAd.playNativeAd(false);
    appGame.appBoxAd.playBox(false);
    appGame.blockAd.playBlockad(false);
    this.node.removeFromParent();
  } // update (dt) {},

});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZUNvbW9uXFxyZXN1bHRcXHJlc3VsdC5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsInRpdGxlIiwiTGFiZWwiLCJjb250ZW50TGFiZWwiLCJuZXh0QnRuIiwiQnV0dG9uIiwiYmFja0J0biIsIm5leHRCdG5DYWxsYmFjayIsImJhY2tCdG5DYWxsYmFjayIsIm9uTG9hZCIsIm5vZGUiLCJvbiIsIk5vZGUiLCJFdmVudFR5cGUiLCJUT1VDSF9FTkQiLCJvbk5leHRCdG5DbGlja2VkIiwib25CYWNrQnRuQ2xpY2tlZCIsInN0YXJ0Iiwic2hvdyIsIm9wdHMiLCJuZXh0Q0IiLCJiYWNrQ0IiLCJpbmZvIiwiY29uZmlnIiwiaXNXaW4iLCJyZXN1bHRDb25maWciLCJ3aW4iLCJmYWlsIiwicmVmcmVzaFVJIiwic3RyaW5nIiwiY29udGVudCIsImdldENoaWxkQnlOYW1lIiwiZ2V0Q29tcG9uZW50IiwiYnRuMSIsIm5hbWUiLCJidG4yIiwiYWN0aXZlIiwiaWNvbiIsImFwcEdhbWUiLCJpbnRlcnN0aXRpYWxBZCIsInBsYXlBZCIsImJhbm5lciIsInBsYXlCYW5uZXIiLCJncmlkQWQiLCJwbGF5R3JpZEFkIiwibmF0aXZlQWQiLCJwbGF5TmF0aXZlQWQiLCJhcHBCb3hBZCIsInBsYXlCb3giLCJibG9ja0FkIiwicGxheUJsb2NrYWQiLCJodHRwVXRpbHMiLCJodHRwUG9zdCIsImNvbnN0cyIsIkhUVFBfUkVDT1JEX1NFUlZFUiIsImV2ZW50IiwiZGVzYyIsImlzUGxheVZpZGVvIiwiaXNGb3JjZSIsInZpZGVvIiwiZm9yY2UiLCJ2aWRlb0Jhbm5lciIsInBsYXlWaWRlb0FkIiwiaXNTdWMiLCJoaWRlIiwiYmluZCIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmVGcm9tUGFyZW50Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBQSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNE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QWlCQyxPQUFqQixDQUF5QixLQUF6QjtBQUNBVixJQUFBQSxPQUFPLENBQUNXLE9BQVIsQ0FBZ0JDLFdBQWhCLENBQTRCLEtBQTVCO0FBQ0EsU0FBS3hDLElBQUwsQ0FBVTBELGdCQUFWO0FBQ0gsR0ExSEksQ0E0SEw7O0FBNUhLLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgdGl0bGU6Y2MuTGFiZWwsXHJcbiAgICAgICAgY29udGVudExhYmVsOmNjLkxhYmVsLFxyXG4gICAgICAgIG5leHRCdG46Y2MuQnV0dG9uLFxyXG4gICAgICAgIGJhY2tCdG46Y2MuQnV0dG9uLFxyXG4gICAgICAgIG5leHRCdG5DYWxsYmFjazogbnVsbCxcclxuICAgICAgICBiYWNrQnRuQ2FsbGJhY2s6IG51bGxcclxuICAgIH0sXHJcblxyXG4gICAgLy8gTElGRS1DWUNMRSBDQUxMQkFDS1M6XHJcblxyXG4gICAgb25Mb2FkICgpIHtcclxuICAgICAgICB0aGlzLm5leHRCdG4ubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsdGhpcy5vbk5leHRCdG5DbGlja2VkLHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYmFja0J0bi5ub2RlLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCx0aGlzLm9uQmFja0J0bkNsaWNrZWQsdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHN0YXJ0ICgpIHtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIG9wdHNcclxuICAgICAqIG5leHRDQiDkuIvkuIDlsYDmjInpkq7lm57osINcclxuICAgICAqIGJhY2tDQiDph43njqnmnKzlhbPmjInpkq7lm57osINcclxuICAgICAqL1xyXG4gICAgIHNob3c6IGZ1bmN0aW9uIChvcHRzKSB7XHJcbiAgICAgICAgb3B0cyA9IG9wdHMgfHwge307XHJcbiAgICAgICAgaWYob3B0cy5uZXh0Q0Ipe1xyXG4gICAgICAgICAgICB0aGlzLm5leHRCdG5DYWxsYmFjayA9IG9wdHMubmV4dENCO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihvcHRzLmJhY2tDQil7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja0J0bkNhbGxiYWNrID0gb3B0cy5iYWNrQ0I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKG9wdHMuaW5mbyl7XHJcbiAgICAgICAgICAgIHRoaXMuaW5mbyA9IG9wdHMuaW5mbztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYob3B0cy5jb25maWcpe1xyXG4gICAgICAgICAgICBpZih0aGlzLmluZm8uaXNXaW4pe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRDb25maWcgPSBvcHRzLmNvbmZpZy53aW47XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRDb25maWcgPSBvcHRzLmNvbmZpZy5mYWlsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVmcmVzaFVJKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlZnJlc2hVSSgpe1xyXG4gICAgICAgIGlmKHRoaXMuaW5mbyl7XHJcbiAgICAgICAgICAgIHRoaXMudGl0bGUuc3RyaW5nID0gdGhpcy5pbmZvLmlzV2luP3RoaXMucmVzdWx0Q29uZmlnLnRpdGxlOnRoaXMucmVzdWx0Q29uZmlnLnRpdGxlO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRMYWJlbC5zdHJpbmcgPSB0aGlzLmluZm8uaXNXaW4/dGhpcy5yZXN1bHRDb25maWcuY29udGVudDp0aGlzLnJlc3VsdENvbmZpZy5jb250ZW50O1xyXG5cclxuICAgICAgICAgICAgdGhpcy5uZXh0QnRuLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ0JhY2tncm91bmQnKS5nZXRDaGlsZEJ5TmFtZSgnTmV3IExhYmVsJykuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0aGlzLnJlc3VsdENvbmZpZy5idG4xLm5hbWU7XHJcbiAgICAgICAgICAgIHRoaXMuYmFja0J0bi5ub2RlLmdldENoaWxkQnlOYW1lKCdCYWNrZ3JvdW5kJykuZ2V0Q2hpbGRCeU5hbWUoJ05ldyBMYWJlbCcpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGhpcy5yZXN1bHRDb25maWcuYnRuMi5uYW1lO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5uZXh0QnRuLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ0JhY2tncm91bmQnKS5nZXRDaGlsZEJ5TmFtZSgnaWNvbicpLmFjdGl2ZSA9IHRoaXMucmVzdWx0Q29uZmlnLmJ0bjEuaWNvbjtcclxuICAgICAgICAgICAgdGhpcy5iYWNrQnRuLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoJ0JhY2tncm91bmQnKS5nZXRDaGlsZEJ5TmFtZSgnaWNvbicpLmFjdGl2ZSA9IHRoaXMucmVzdWx0Q29uZmlnLmJ0bjIuaWNvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoYXBwR2FtZS5pbnRlcnN0aXRpYWxBZCl7XHJcbiAgICAgICAgICAgIGFwcEdhbWUuaW50ZXJzdGl0aWFsQWQucGxheUFkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFwcEdhbWUuYmFubmVyLnBsYXlCYW5uZXIoMik7XHJcbiAgICAgICAgYXBwR2FtZS5ncmlkQWQucGxheUdyaWRBZCh0cnVlKTtcclxuICAgICAgICBhcHBHYW1lLm5hdGl2ZUFkLnBsYXlOYXRpdmVBZCh0cnVlKTtcclxuICAgICAgICBhcHBHYW1lLmFwcEJveEFkLnBsYXlCb3godHJ1ZSk7XHJcbiAgICAgICAgYXBwR2FtZS5ibG9ja0FkLnBsYXlCbG9ja2FkKHRydWUsNCk7XHJcbiAgICAgICAgaHR0cFV0aWxzLmh0dHBQb3N0KGNvbnN0cy5IVFRQX1JFQ09SRF9TRVJWRVIse3RpdGxlOifnu5PnrpcnLGNvbnRlbnQ6J+aJk+W8gOe7k+eul+eVjOmdoid9LGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uTmV4dEJ0bkNsaWNrZWQoZXZlbnQpe1xyXG4gICAgICAgIGh0dHBVdGlscy5odHRwUG9zdChjb25zdHMuSFRUUF9SRUNPUkRfU0VSVkVSLHt0aXRsZTon57uT566XJyxjb250ZW50OifkuIvkuIDlhbMnLGRlc2M6J+eCueWHuyd9LGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbGV0IGlzUGxheVZpZGVvID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGlzRm9yY2UgPSB0cnVlO1xyXG4gICAgICAgIGlmKHRoaXMucmVzdWx0Q29uZmlnKXtcclxuICAgICAgICAgICAgaXNQbGF5VmlkZW8gPSB0aGlzLnJlc3VsdENvbmZpZy5idG4xLnZpZGVvO1xyXG4gICAgICAgICAgICBpc0ZvcmNlID0gdGhpcy5yZXN1bHRDb25maWcuYnRuMS5mb3JjZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoaXNQbGF5VmlkZW8pe1xyXG4gICAgICAgICAgICBhcHBHYW1lLnZpZGVvQmFubmVyLnBsYXlWaWRlb0FkKDMsaXNGb3JjZSxmdW5jdGlvbihpc1N1Yyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRCdG5DYWxsYmFjayAmJiB0aGlzLm5leHRCdG5DYWxsYmFjayh0aGlzLmluZm8uaXNXaW4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMubmV4dEJ0bkNhbGxiYWNrICYmIHRoaXMubmV4dEJ0bkNhbGxiYWNrKHRoaXMuaW5mby5pc1dpbik7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgb25CYWNrQnRuQ2xpY2tlZChldmVudCl7XHJcbiAgICAgICAgaHR0cFV0aWxzLmh0dHBQb3N0KGNvbnN0cy5IVFRQX1JFQ09SRF9TRVJWRVIse3RpdGxlOifnu5PnrpcnLGNvbnRlbnQ6J+WGjeadpeS4gOWxgCvngrnlh7snfSxmdW5jdGlvbigpe1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxldCBpc1BsYXlWaWRlbyA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBpc0ZvcmNlID0gdHJ1ZTtcclxuICAgICAgICBpZih0aGlzLnJlc3VsdENvbmZpZyl7XHJcbiAgICAgICAgICAgIGlzUGxheVZpZGVvID0gdGhpcy5yZXN1bHRDb25maWcuYnRuMi52aWRlbztcclxuICAgICAgICAgICAgaXNGb3JjZSA9IHRoaXMucmVzdWx0Q29uZmlnLmJ0bjIuZm9yY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKGlzUGxheVZpZGVvKXsvL+mFjee9rumcgOimgeaSreaUvuinhumikVxyXG4gICAgICAgICAgICBhcHBHYW1lLnZpZGVvQmFubmVyLnBsYXlWaWRlb0FkKDMsaXNGb3JjZSxmdW5jdGlvbihpc1N1Yyl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIueci+inhumikeaIkOWKn1wiKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5iYWNrQnRuQ2FsbGJhY2sgJiYgdGhpcy5iYWNrQnRuQ2FsbGJhY2sodGhpcy5pbmZvLmlzV2luKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xyXG4gICAgICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIH1lbHNley8v5LiN55So5pKt5pS+6KeG6aKRXHJcbiAgICAgICAgICAgIHRoaXMuYmFja0J0bkNhbGxiYWNrICYmIHRoaXMuYmFja0J0bkNhbGxiYWNrKHRoaXMuaW5mby5pc1dpbik7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBoaWRlKCl7XHJcbiAgICAgICAgaHR0cFV0aWxzLmh0dHBQb3N0KGNvbnN0cy5IVFRQX1JFQ09SRF9TRVJWRVIse3RpdGxlOifnu5PnrpcnLGNvbnRlbnQ6J+WFs+mXree7k+eul+eVjOmdoid9LGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYXBwR2FtZS5iYW5uZXIucGxheUJhbm5lcigzKTtcclxuICAgICAgICBhcHBHYW1lLmdyaWRBZC5wbGF5R3JpZEFkKGZhbHNlKTtcclxuICAgICAgICBhcHBHYW1lLm5hdGl2ZUFkLnBsYXlOYXRpdmVBZChmYWxzZSk7XHJcbiAgICAgICAgYXBwR2FtZS5hcHBCb3hBZC5wbGF5Qm94KGZhbHNlKTtcclxuICAgICAgICBhcHBHYW1lLmJsb2NrQWQucGxheUJsb2NrYWQoZmFsc2UpO1xyXG4gICAgICAgIHRoaXMubm9kZS5yZW1vdmVGcm9tUGFyZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdXBkYXRlIChkdCkge30sXHJcbn0pO1xyXG4iXX0=