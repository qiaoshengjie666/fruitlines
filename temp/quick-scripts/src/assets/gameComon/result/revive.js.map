{"version":3,"sources":["assets\\gameComon\\result\\revive.js"],"names":["backBtnTimeOut","continueBtnTimeOut","countDownInterval","cc","Class","Component","properties","reviveBtn","Button","backBtn","clock","Node","reviveBtnCallback","backBtnCallback","onLoad","node","on","EventType","TOUCH_END","onReviveBtnClicked","onBackBtnClicked","start","show","opts","reviveCB","backCB","config","reviveConfig","refreshUI","_count","getComponent","ProgressBar","progress","countdown","updateTime","btn1","getChildByName","Label","string","name","active","icon","clearTimeout","delayTime","setTimeout","bind","btn2","appGame","interstitialAd","playAd","banner","playBanner","appBoxAd","playBox","blockAd","playBlockad","httpUtils","httpPost","consts","HTTP_RECORD_SERVER","title","content","event","desc","isPlayVideo","isForce","video","force","videoBanner","playVideoAd","isSuc","console","log","hide","type","count","totalcount","durationtime","clearInterval","setInterval","removeFromParent"],"mappings":"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","sourceRoot":"/","sourcesContent":["var backBtnTimeOut;\r\nvar continueBtnTimeOut;\r\nvar countDownInterval;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        reviveBtn:cc.Button,\r\n        backBtn:cc.Button,\r\n        clock:cc.Node,\r\n        reviveBtnCallback: null,\r\n        backBtnCallback: null\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.reviveBtn.node.on(cc.Node.EventType.TOUCH_END,this.onReviveBtnClicked,this);\r\n        this.backBtn.node.on(cc.Node.EventType.TOUCH_END,this.onBackBtnClicked,this);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n    /**\r\n     * @param opts\r\n     * backCB 放弃按钮回调\r\n     * reviveCB 复活按钮回调\r\n     */\r\n     show: function (opts) {\r\n        opts = opts || {};\r\n        if(opts.reviveCB){\r\n            this.reviveBtnCallback = opts.reviveCB;\r\n        }\r\n        if(opts.backCB){\r\n            this.backBtnCallback = opts.backCB;\r\n        }\r\n        if(opts.config){\r\n            this.reviveConfig = opts.config;\r\n        }\r\n        this.refreshUI();\r\n    },\r\n    refreshUI(){\r\n        this._count = 0;\r\n        this.clock.getComponent(cc.ProgressBar).progress = 1;\r\n        if(this.reviveConfig.countdown){\r\n            this.updateTime(1,this.reviveConfig.countdown,this.reviveConfig.countdown);\r\n        }\r\n        if(this.reviveConfig.btn1){\r\n            this.reviveBtn.node.getChildByName('Background').getChildByName('New Label').getComponent(cc.Label).string = this.reviveConfig.btn1.name;\r\n            this.reviveBtn.node.getChildByName('Background').getChildByName('icon').active = this.reviveConfig.btn1.icon;\r\n            clearTimeout(continueBtnTimeOut);\r\n            if(this.reviveConfig.btn1.delayTime>=0){\r\n                continueBtnTimeOut = setTimeout(function(){\r\n                    this.reviveBtn.node.active = true;\r\n                }.bind(this),this.reviveConfig.btn1.delayTime*1000);\r\n            }\r\n        }\r\n\r\n        if(this.reviveConfig.btn2){\r\n            this.backBtn.node.getChildByName('Background').getChildByName('New Label').getComponent(cc.Label).string = this.reviveConfig.btn2.name;\r\n            this.backBtn.node.getChildByName('Background').getChildByName('icon').active = this.reviveConfig.btn2.icon;\r\n            this.backBtn.node.active = false;\r\n            clearTimeout(backBtnTimeOut);\r\n            if(this.reviveConfig.btn2.delayTime>=0){\r\n            backBtnTimeOut = setTimeout(function(){\r\n                    this.backBtn.node.active = true;\r\n                }.bind(this),this.reviveConfig.btn2.delayTime*1000);\r\n            }\r\n        }\r\n        \r\n        if(appGame.interstitialAd){\r\n            appGame.interstitialAd.playAd();\r\n        }\r\n        appGame.banner.playBanner(2);\r\n        appGame.appBoxAd.playBox(true);\r\n        appGame.blockAd.playBlockad(true,4);\r\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'复活',content:'打开复活界面'},function(){\r\n        });\r\n    },\r\n\r\n    onReviveBtnClicked(event){\r\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'复活',content:'复活',desc:'点击'},function(){\r\n        });\r\n        let isPlayVideo = false;\r\n        let isForce = true;\r\n        if(this.reviveConfig){\r\n            isPlayVideo = this.reviveConfig.btn1.video;\r\n            isForce = this.reviveConfig.btn1.force;\r\n        }\r\n        if(isPlayVideo){\r\n            appGame.videoBanner.playVideoAd(2,isForce,function(isSuc){\r\n                console.log(\"看视频成功\")\r\n                this.reviveBtnCallback && this.reviveBtnCallback();\r\n                this.hide();\r\n            }.bind(this));\r\n        }else{\r\n            this.reviveBtnCallback && this.reviveBtnCallback();\r\n            this.hide();\r\n        }\r\n        \r\n    },\r\n\r\n    onBackBtnClicked(event){\r\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'复活',content:'返回',desc:'点击'},function(){\r\n        });\r\n        let isPlayVideo = false;\r\n        let isForce = true;\r\n        if(this.reviveConfig){\r\n            isPlayVideo = this.reviveConfig.btn2.video;\r\n            isForce = this.reviveConfig.btn2.force;\r\n        }\r\n        if(isPlayVideo){//配置需要播放视频\r\n            appGame.videoBanner.playVideoAd(2,isForce,function(isSuc){\r\n                console.log(\"看视频成功\")\r\n                this.backBtnCallback && this.backBtnCallback();\r\n                this.hide();\r\n            }.bind(this));\r\n        }else{//不用播放视频\r\n            this.backBtnCallback && this.backBtnCallback();\r\n            this.hide();\r\n        }\r\n    },\r\n\r\n    updateTime(type,count,totalcount){\r\n        if(type==1){//开始倒计时\r\n            count = count*1000;\r\n            totalcount = totalcount*1000;\r\n            let durationtime = 100;\r\n            this._count = count;\r\n            if(this.clock){\r\n                this.clock.getComponent(cc.ProgressBar).progress = this._count/totalcount;\r\n            }\r\n            clearInterval(countDownInterval);\r\n            countDownInterval = setInterval(function() {\r\n                if(this._count>durationtime){\r\n                    this._count-=durationtime;\r\n                }else{\r\n                    this._count = 0;\r\n                    clearInterval(countDownInterval);\r\n                    this.backBtnCallback && this.backBtnCallback();\r\n                    this.hide();\r\n                }\r\n                if(this.clock){\r\n                    this.clock.getComponent(cc.ProgressBar).progress = this._count/totalcount;\r\n                }\r\n            }.bind(this), durationtime);\r\n        }else{//关闭倒计时\r\n            clearInterval(countDownInterval);\r\n        }\r\n    },\r\n\r\n    hide(){\r\n        httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'复活',content:'关闭复活界面'},function(){\r\n        });\r\n        appGame.banner.playBanner(3);\r\n        appGame.appBoxAd.playBox(false);\r\n        appGame.blockAd.playBlockad(false);\r\n        clearInterval(countDownInterval);\r\n        clearTimeout(backBtnTimeOut);\r\n        clearTimeout(continueBtnTimeOut);\r\n        this.node.removeFromParent();\r\n    }\r\n\r\n    // update (dt) {},\r\n});\r\n"]}