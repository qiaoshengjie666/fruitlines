{"version":3,"sources":["assets\\gameComon\\scripts\\ad\\qqBlockAd.js"],"names":["videoId","BlockAd","cc","Class","Component","properties","ctor","instance","statics","create","data","initWithData","targetBannerAdWidth","playBlockad","show","count","sys","platform","WECHAT_GAME","appGame","globalData","blockAd","destroy","res","qq","getSystemInfoSync","width","windowWidth","height","windowHeight","Version2","util","compareVersion","SDKVersion","gameServerRoom","adConfig","blockId","QQ","adUnitId","createBlockAd","size","orientation","style","left","top","httpUtils","httpPost","consts","HTTP_RECORD_SERVER","title","content","desc","onError","listener","errCode","errMsg","onLoad","console","log","then","refreshSize","bannerAd","onResize","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var videoId = '';\r\nvar BlockAd = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n    },\r\n    ctor(){\r\n        this.instance = null;\r\n    },\r\n    statics: {\r\n        create: function (data) {\r\n            if(!this.instance){\r\n                this.instance = new BlockAd();\r\n                this.instance.initWithData(data);\r\n                return this.instance;\r\n            }\r\n        }\r\n    },\r\n    initWithData: function (data) {\r\n        this.targetBannerAdWidth = 200;  \r\n    },\r\n    playBlockad:function(show,count = 4){\r\n        if(cc.sys.platform == cc.sys.WECHAT_GAME &&appGame.platform == 'QQ'){ //QQ\r\n          if(show){\r\n            if(this.globalData && this.globalData.blockAd){\r\n              this.globalData.blockAd.destroy();\r\n            }\r\n            const res = qq.getSystemInfoSync();\r\n            this.width = res.windowWidth;\r\n            this.height = res.windowHeight;\r\n            var Version2 = util.compareVersion(res.SDKVersion,\"1.15.0\");\r\n            //if(Version2 > 0){\r\n                videoId = \"672c9551ab8b8b8284a73dde8cf1406a\";\r\n                if(appGame.gameServerRoom.adConfig && appGame.gameServerRoom.adConfig.blockId && appGame.gameServerRoom.adConfig.blockId.QQ){\r\n                  videoId = appGame.gameServerRoom.adConfig.blockId.QQ.adUnitId;\r\n                }\r\n                this.globalData = {\r\n                    blockAd: qq.createBlockAd({\r\n                      adUnitId: videoId,\r\n                      size: count,\r\n                      orientation: 'landscape',\r\n                      style: {\r\n                        //left: 16,\r\n                        //top: this.height - (this.targetBannerAdWidth / 16) * 9, // 根据系统约定尺寸计算出广告高度,\r\n                        // width: this.targetBannerAdWidth,\r\n                        left:16,\r\n                        top:100,\r\n                      }\r\n                    })\r\n                }\r\n                httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'积木广告',content:'创建成功',desc:videoId},function(){\r\n                });\r\n                //this.refreshSize();\r\n                this.globalData.blockAd.onError(res=>{\r\n                  httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'积木广告',content:videoId,desc:listener.errCode+listener.errMsg},function(){\r\n                  });\r\n                });\r\n                this.globalData.blockAd.onLoad(res=>{\r\n                  console.log('globalData blockAd onLoad',res)\r\n                  this.globalData.blockAd.show().then(()=>{\r\n                    httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'积木广告',content:'展示成功',desc:videoId},function(){\r\n                    });\r\n                  }).catch((res)=>{\r\n                    httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'积木广告',content:'展示失败',desc:videoId},function(){\r\n                    });\r\n                  });\r\n                })\r\n          }else{\r\n              if(this.globalData && this.globalData.blockAd){\r\n                this.globalData.blockAd.destroy();\r\n                httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'积木广告',content:'隐藏',desc:videoId},function(){\r\n                });\r\n              }\r\n          }  \r\n          }\r\n      },\r\n      refreshSize(){\r\n        if(this.globalData && this.globalData.bannerAd){\r\n            if(cc.sys.platform == cc.sys.WECHAT_GAME &&appGame.platform == 'QQ'){ //QQ\r\n                this.globalData.blockAd.onResize((size) => {\r\n                    console.log(\"积木广告 shezhi大小\"+this.height+\"   \"+this.width)\r\n                    this.globalData.blockAd.style.top = this.height - size.height;\r\n                    this.globalData.blockAd.style.left = (this.width - size.width) / 2;\r\n                });\r\n            }\r\n        }\r\n    },\r\n});\r\nmodule.exports = BlockAd;\r\n"]}