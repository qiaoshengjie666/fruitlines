{"version":3,"sources":["assets\\gameComon\\scripts\\ad\\interstitialAd.js"],"names":["InterstitialAd","cc","Class","properties","ctor","instance","statics","create","data","initWithData","adId","sys","platform","WECHAT_GAME","appGame","gameServerRoom","adConfig","interstitialId","QQ","adUnitId","globalData","interstitialAd","qq","createInterstitialAd","console","log","httpUtils","httpPost","consts","HTTP_RECORD_SERVER","title","content","desc","WX","BYTEDANCE_GAME","toutiao","playAd","gameConfigData","isbanner","destroy","tt","load","then","show","err","onError","listener","errCode","errMsg","offError","wx","error","onLoad","onClose","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var InterstitialAd = cc.Class({\r\n    properties: {\r\n    },\r\n    ctor(){\r\n        this.instance = null;\r\n    },\r\n    statics: {\r\n        create: function (data) {\r\n            if(!this.instance){\r\n                this.instance = new InterstitialAd();\r\n                this.instance.initWithData(data);\r\n                return this.instance;\r\n            }\r\n        }\r\n    },\r\n    initWithData: function (data) {\r\n        this.adId = '';\r\n        if(cc.sys.platform == cc.sys.WECHAT_GAME && appGame.platform == 'QQ'){ //qq\r\n            this.adId = 'e93d7d4378e53c49b258b80960fb84c1';\r\n            if(appGame.gameServerRoom.adConfig && appGame.gameServerRoom.adConfig.interstitialId && appGame.gameServerRoom.adConfig.interstitialId.QQ){\r\n                this.adId = appGame.gameServerRoom.adConfig.interstitialId.QQ.adUnitId;\r\n            }\r\n            this.globalData = {\r\n                interstitialAd: qq.createInterstitialAd({\r\n                    adUnitId: this.adId\r\n                }),\r\n            }\r\n            console.log(\"插屏广告==\"+this.adId)\r\n            httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'创建成功',desc:this.adId},function(){\r\n            });\r\n        }else if(cc.sys.platform == cc.sys.WECHAT_GAME && appGame.platform == 'WX'){ //微信\r\n            this.adId = 'c5b484afd6953432';\r\n            if(appGame.gameServerRoom.adConfig && appGame.gameServerRoom.adConfig.interstitialId && appGame.gameServerRoom.adConfig.interstitialId.WX){\r\n                this.adId = appGame.gameServerRoom.adConfig.interstitialId.WX.adUnitId;\r\n            }\r\n            httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'创建成功',desc:this.adId},function(){\r\n            });\r\n        }else if(cc.sys.platform == cc.sys.BYTEDANCE_GAME){ //字节\r\n            this.adId = '15c24vd9ppqti8jgb3';\r\n            if(appGame.gameServerRoom.adConfig && appGame.gameServerRoom.adConfig.interstitialId && appGame.gameServerRoom.adConfig.interstitialId.toutiao){\r\n                this.adId = appGame.gameServerRoom.adConfig.interstitialId.toutiao.adUnitId;\r\n            }\r\n            httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'创建成功',desc:this.adId},function(){\r\n            });\r\n        }\r\n    },\r\n    playAd:function() {\r\n        if(cc.sys.platform == cc.sys.BYTEDANCE_GAME && appGame.gameServerRoom.gameConfigData&&\r\n            appGame.gameServerRoom.gameConfigData.isbanner){\r\n            console.log(\"banner return\")\r\n            return;\r\n        }\r\n        console.log(\"播放插屏广告==\")\r\n        if(cc.sys.platform == cc.sys.BYTEDANCE_GAME){ //头条平台\r\n            if(this.globalData && this.globalData.interstitialAd){\r\n                this.globalData.interstitialAd.destroy(); \r\n                this.globalData.interstitialAd = null; \r\n            }\r\n            this.globalData = {\r\n                interstitialAd: tt.createInterstitialAd({\r\n                    adUnitId: this.adId\r\n                }),\r\n            }\r\n            httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'创建成功',desc:this.adId},function(){\r\n            });\r\n            this.globalData.interstitialAd.load()\r\n            .then(() => {\r\n                console.log(\"插屏显示成功\");\r\n                httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'显示成功',desc:this.adId},function(){\r\n                });\r\n                return this.globalData.interstitialAd.show();\r\n            })\r\n            .catch((err) => {\r\n                httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'显示失败',desc:this.adId},function(){\r\n                });\r\n                console.log(\"插屏组件出现问题\", err);\r\n            });\r\n            this.globalData.interstitialAd.onError((listener) => {\r\n                httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:this.adId,desc:listener.errCode+listener.errMsg},function(){\r\n                });\r\n            });\r\n            \r\n        }else if (cc.sys.platform == cc.sys.WECHAT_GAME && appGame.platform == 'WX') { //微信平台\r\n            if (this.globalData && this.globalData.interstitialAd) {\r\n                this.globalData.interstitialAd.offError();\r\n                this.globalData.interstitialAd.destroy();\r\n                this.globalData.interstitialAd = null;\r\n                console.log(\"销毁\")\r\n                httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'销毁广告',desc:this.adId},function(){\r\n                });\r\n            }\r\n            this.globalData = {\r\n                /* 建议放在onReady里执行，提前加载广告 */\r\n                InterstitialAd :wx.createInterstitialAd({\r\n                    adUnitId: this.adId\r\n                })\r\n            }\r\n            httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'创建成功',desc:this.adId},function(){\r\n            });\r\n            this.globalData.InterstitialAd.load().catch((err) => {\r\n                console.error('load', err)\r\n            })\r\n            this.globalData.InterstitialAd.onLoad(() => {\r\n                console.log('onLoad event emit')\r\n                this.globalData.InterstitialAd.show().catch((err) => {\r\n                    httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'显示成功',desc:this.adId},function(){\r\n                    });\r\n                    console.error('show', err)\r\n                })\r\n            })\r\n            this.globalData.InterstitialAd.onClose(() => {\r\n                console.log('close event emit')\r\n            })\r\n            this.globalData.InterstitialAd.onError((listener) => {\r\n                httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:this.adId,desc:listener.errCode+listener.errMsg},function(){\r\n                });\r\n            })\r\n            /* 建议放在需要展示插屏广告的时机执行 */\r\n        }else{\r\n            if(this.globalData && this.globalData.interstitialAd){\r\n                let interstitialAd = this.globalData.interstitialAd;\r\n                interstitialAd\r\n                .load()\r\n                .then(() => {\r\n                    console.log(\"插屏显示成功\");\r\n                    httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'显示成功',desc:this.adId},function(){\r\n                    });\r\n                    return interstitialAd.show();\r\n                })\r\n                .catch((err) => {\r\n                    httpUtils.httpPost(consts.HTTP_RECORD_SERVER,{title:'插屏广告',content:'显示失败',desc:this.adId},function(){\r\n                    });\r\n                    console.log(\"插屏组件出现问题\", err);\r\n                });\r\n            }\r\n        }\r\n    }\r\n});\r\nmodule.exports = InterstitialAd;\r\n"]}