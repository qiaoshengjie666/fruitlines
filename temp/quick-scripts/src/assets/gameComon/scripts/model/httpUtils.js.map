{"version":3,"sources":["assets\\gameComon\\scripts\\model\\httpUtils.js"],"names":["module","exports","onLoad","httpGet","url","cb","xhr","cc","loader","getXMLHttpRequest","onreadystatechange","readyState","status","respone","responseText","onerror","error","log","sys","isNative","setRequestHeader","open","timeout","send","httpGets","callback","timedout","timer","setTimeout","abort","clearTimeout","httpPost","params","query","snmiguid","localStorage","getItem","encodeURIComponent","JSON","stringify","appGame","deviceInfo","Date","getTime","info","consts","HTTP_RECORD_PACKAGE","HTTP_RECORD_PACKAGENAME","packageVersion","platform","title","content","desc","geturl","Object","keys","map","key","join","httpSendRequest","respones","parse","httpPostParam","console","pars","payload","loadNetToNativeImg","dirpath","jsb","fileUtils","getWritablePath","filepath","MD5","loadEnd","load","err","tex","spriteFrame","SpriteFrame","retain","isFileExist","saveFile","data","isDirectoryExist","createDirectory","writeDataToFile","Uint8Array","XMLHttpRequest","responseType","response","bind"],"mappings":"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","sourceRoot":"/","sourcesContent":["module.exports = {\n  \n    onLoad: function () {  \n    },\n\n    httpGet: function(url, cb) {\n        var xhr = cc.loader.getXMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\n                var respone = xhr.responseText;\n                cb && cb(null, respone);\n            }\n            else if(xhr.readyState === 4&& (xhr.status > 400||xhr.status ==0) ){\n                cb && cb(xhr.status);\n            }\n        };\n        xhr.onerror = function (error) {\n            cc.log('httpUtils onreadystatechange  onerror===='+xhr.readyState+'==='+xhr.status);\n            if ((xhr.readyState == 4 && xhr.status == 0)||(xhr.readyState == 1 && xhr.status == 0)) {\n                cb && cb(503); //503   （服务不可用） 服务器目前无法使用（由于超载或停机维护）\n            }\n        };\n        if (cc.sys.isNative) {\n            xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");\n        }\n        xhr.open(\"GET\", url, true);\n        xhr.timeout = 5000;// 5 seconds for timeout\n        xhr.send();\n    },\n  \n    httpGets: function (url, callback) {  \n        cc.log(\"url==\"+url)\n        var xhr = cc.loader.getXMLHttpRequest();  \n        var timedout =false;\n        var timer = setTimeout(function(){\n            timedout =true;\n            xhr.abort();\n            callback();\n        },2000);\n        xhr.onreadystatechange = function () {  \n            if(xhr.readyState == 4){\n                if(timedout){return;}\n                clearTimeout(timer);\n                if (xhr.status >= 200 && xhr.status < 300) {  \n                    var respone = xhr.responseText;  \n                    if(respone){\n                        callback(respone);\n                    }\n                } \n                else if(xhr.status > 400||xhr.status ==0){\n                    callback(\"false\");  \n                }\n            }\n        };  \n        xhr.open(\"GET\", url, true);  \n        xhr.setRequestHeader(\"Content-Type\",\"text/plain;charset=UTF-8\");\n        if (cc.sys.isNative) {  \n            xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");  \n        }   \n        xhr.send();  \n    },  \n  \n    httpPost: function (url, params, callback) { \n        let query = [];\n        let snmiguid = cc.sys.localStorage.getItem('snmi_guid')\n        query['snmi'] = encodeURIComponent(JSON.stringify(snmiguid));\n        query['deviceInfo'] = encodeURIComponent(JSON.stringify(appGame.deviceInfo)); \n        query['timestamp'] = new Date().getTime();\n        let info = {\n            'package':consts.HTTP_RECORD_PACKAGE,\n            'packageName':consts.HTTP_RECORD_PACKAGENAME,\n            'packageVersion':appGame.packageVersion,\n            'versionCode': '1',\n            'platfrom':appGame.platform\n        }\n        query['manifest'] = encodeURIComponent(JSON.stringify(info));\n        query['title'] = encodeURIComponent(params.title);\n        query['content'] = encodeURIComponent(params.content);\n        if(params.desc){\n            query['desc'] = encodeURIComponent(params.desc);\n        }else{\n            query['desc'] = encodeURIComponent('');\n        }\n        var xhr = cc.loader.getXMLHttpRequest();  \n        xhr.onreadystatechange = function () {  \n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {  \n                var respone = xhr.responseText;  \n                if(respone){\n                    callback(respone); \n                }\n            }else{  \n                callback(-1);  \n            }  \n        };  \n        //xhr.open(\"POST\", url, true);\n        //xhr.send(params);  decodeURIComponent\n        let geturl = `${url}?${Object.keys(query).map(key=> `${key}=${query[key]}`).join('&')}`\n        //cc.log(\"geturl====\"+geturl)\n        xhr.open(\"GET\", geturl, true);\n        xhr.send(); \n    },\n    \n    httpSendRequest: function (url, callback) {\n        //cc.log(\"url===\"+url)\n        let xhr = cc.loader.getXMLHttpRequest();\n        let timedout =false;\n        let timer = setTimeout(function(){\n            timedout =true;\n            xhr.abort();\n            callback(-1);\n        },2000);\n        xhr.onreadystatechange = function () {\n            if(xhr.readyState == 4){\n                if(timedout){return;}\n                clearTimeout(timer);\n                if (xhr.status >= 200 && xhr.status < 300) {  \n                    let respone = xhr.responseText;\n                    if(respone){\n                        let respones = JSON.parse(respone)\n                        callback(respones);  \n                    }else{\n                        callback(1);\n                    }\n                } \n                else if(xhr.status > 400||xhr.status ==0){\n                    callback(-1);  \n                }\n            }\n        };  \n        xhr.open(\"POST\", url, true);\n        xhr.send();\n        //xhr.open(\"POST\", url, true);\n        //xhr.send(params);\n    },\n\n    httpPostParam: function (url, params, callback) {  \n        var xhr = cc.loader.getXMLHttpRequest();  \n        xhr.onreadystatechange = function () {  \n            console.log('xhr.readyState='+xhr.readyState+'  xhr.status='+xhr.status);  \n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\n                var respone = xhr.responseText;\n                if(respone){\n                    var pars =  JSON.parse(respone)\n                    callback(pars);  \n                }\n            }else{  \n                callback(-1);  \n            }  \n        };  \n        xhr.open(\"POST\", url, true); \n        //xhr.setRequestHeader('Access-Control-Allow-Origin', '*'); \n        //xhr.setRequestHeader('content-type', 'application/json')\n        xhr.timeout = 5000;// 5 seconds for timeout  \n        let payload = JSON.stringify(params);\n        xhr.send(payload);  \n    },\n\n    loadNetToNativeImg : function(url, callback){\n        var dirpath =  jsb.fileUtils.getWritablePath() + 'img/';\n        var filepath = dirpath + MD5(url) + '.png';\n\n        function loadEnd(){\n            cc.loader.load(filepath, function(err, tex){\n                if( err ){\n                    cc.error(err);\n                }else{\n                    var spriteFrame = new cc.SpriteFrame(tex);\n                    if( spriteFrame ){\n                        spriteFrame.retain();\n                        callback(spriteFrame);\n                    }\n                }\n            });\n        }\n\n        if( jsb.fileUtils.isFileExist(filepath) ){\n            cc.log('Remote is find' + filepath);\n            loadEnd();\n            return;\n        }\n        var saveFile = function(data){\n            if( typeof data !== 'undefined' ){\n                if( !jsb.fileUtils.isDirectoryExist(dirpath) ){\n                    jsb.fileUtils.createDirectory(dirpath);\n                }\n                if( jsb.fileUtils.writeDataToFile(  new Uint8Array(data) , filepath) ){\n                    cc.log('Remote write file succeed.');\n                    loadEnd();\n                }else{\n                    cc.log('Remote write file failed.');\n                }\n            }else{\n                cc.log('Remote download file failed.');\n            }\n        };\n        var xhr = new XMLHttpRequest();\n\n        xhr.onreadystatechange = function () {\n            cc.log(\"xhr.readyState  \" +xhr.readyState);\n            cc.log(\"xhr.status  \" +xhr.status);\n            if (xhr.readyState === 4) {\n                if(xhr.status === 200){\n                    xhr.responseType = 'arraybuffer';\n                    saveFile(xhr.response);\n                }else{\n                    saveFile(null);\n                }\n            }\n        }.bind(this);\n        xhr.open(\"GET\", url, true);\n        xhr.send();\n    }\n\n};  \n"]}