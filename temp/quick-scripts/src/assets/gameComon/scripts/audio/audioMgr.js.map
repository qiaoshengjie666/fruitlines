{"version":3,"sources":["assets\\gameComon\\scripts\\audio\\audioMgr.js"],"names":["AudioMgr","cc","Class","properties","bgmAudioID","audioId","gameMusicAudio","bgUrl","bgLoop","ctor","sys","localStorage","setItem","gMusic","getItem","game","on","EVENT_HIDE","audioEngine","pauseAll","EVENT_SHOW","resumeAll","getUrl","url","cb","assetManager","loadBundle","err","bundle","load","AudioClip","clip","bind","getMusicStatus","setMusicOnOff","isOpen","playBGM","stopAll","removeItem","isLoop","audioUrl","stop","playMusic","log","playSFX","play","pauseBGM","pause","resumeBGM","resume","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var AudioMgr = cc.Class({\n    properties: {\n        bgmAudioID: -1,\n        audioId: 1,\n        gameMusicAudio:true,\n\n        bgUrl:'',\n        bgLoop:false\n    },\n\n    // use this for initialization\n    ctor: function () {\n        cc.sys.localStorage.setItem(\"gameMusic\",1);\n        let gMusic = cc.sys.localStorage.getItem(\"gameMusic\");\n        if (gMusic == null || gMusic == '') {\n            this.gameMusicAudio = false;\n        }else{\n            this.gameMusicAudio = true;\n        }\n        cc.game.on(cc.game.EVENT_HIDE, function () {\n            cc.audioEngine.pauseAll();\n        });\n        cc.game.on(cc.game.EVENT_SHOW, function () {\n            cc.audioEngine.resumeAll();\n        });\n    },\n\n    getUrl: function (url,cb) {\n        if(!this.gameMusicAudio){\n            return;\n        }\n        cc.assetManager.loadBundle('comSound', function(err, bundle){\n            bundle.load(url, cc.AudioClip, function (err, clip) {\n                if(err){\n                    return;\n                }\n                cb(clip);\n            }.bind(this));\n        }.bind(this));\n    },\n\n    getMusicStatus:function(cb){\n        let gMusic = cc.sys.localStorage.getItem(\"gameMusic\");\n        if (gMusic == null || gMusic == '') {\n            cb(false);\n        }else{\n            cb(true);\n        }\n    },\n\n    setMusicOnOff:function(isOpen){\n        if(isOpen){  //å¼€\n            this.gameMusicAudio = true;\n            cc.sys.localStorage.setItem(\"gameMusic\",1);\n            if(this.bgUrl){\n                this.playBGM(this.bgUrl,this.bgLoop);\n            }\n        }else{\n            this.stopAll();\n            this.gameMusicAudio = false;\n            cc.sys.localStorage.removeItem(\"gameMusic\");\n        }\n    },\n\n    playBGM: function (url,isLoop) {\n        this.bgUrl = url;\n        this.bgLoop = isLoop;\n        this.getUrl(url,function(audioUrl){\n            if(audioUrl){\n                cc.audioEngine.stop(this.bgmAudioID)\n                this.bgmAudioID = cc.audioEngine.playMusic(audioUrl, isLoop);\n            }\n            cc.log(\"this.bgmAudioID=====\"+this.bgmAudioID)\n        }.bind(this));\n    },\n\n    playSFX: function (url) {\n        this.getUrl(url,function(audioUrl){\n            this.audioId = cc.audioEngine.play(audioUrl, false,1);\n        }.bind(this));\n    },\n\n    pauseBGM: function () {\n        cc.log(\"pauseBGM\")\n        cc.audioEngine.pause(this.bgmAudioID);\n    },\n\n    resumeBGM: function () {\n        if(this.gameMusicAudio){\n            cc.log(\"resumeBGM\")\n            cc.audioEngine.resume(this.bgmAudioID);\n        }\n    },\n\n    pauseAll: function () {\n        cc.audioEngine.pauseAll();\n    },\n\n    resumeAll: function () {\n        cc.audioEngine.resumeAll();\n    },\n\n    stopAll:function(){\n        cc.audioEngine.stopAll();\n    }\n});\n\nmodule.exports = AudioMgr;\n"]}