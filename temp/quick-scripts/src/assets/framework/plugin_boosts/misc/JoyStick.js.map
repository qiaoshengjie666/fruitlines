{"version":3,"sources":["assets\\framework\\plugin_boosts\\misc\\JoyStick.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class JoyStick extends cc.Component\n{\n    @property(cc.Node)\n    outterCircle:cc.Node = null;\n\n    @property(cc.Node)\n    innerCircle:cc.Node = null;\n\n    @property\n    radius:number = 250;\n\n    @property\n    innerCircleRadius:number =  20;\n\n    // 超出是否relase \n    @property\n    releaseAfterOver:boolean = false;\n\n    // dynamic Joystick\n    @property\n    dynamicJoystick:boolean = false;\n\n    @property\n    autoRadius:boolean = false;\n\n    isReleased = false;\n    onLoad()\n    {\n        if(this.autoRadius)\n        {\n            this.radius = this.outterCircle.getBoundingBox().height/2;\n        }\n        this.innerCircle.setPosition(0,0);\n        this.node.active = false;\n    }\n\n    start()\n    {\n        this.releaseStick();\n    }\n    \n    releaseStick()\n    {\n        let move = cc.moveTo(0.5 , cc.Vec2.ZERO);\n        let action = move.easing(cc.easeExponentialOut());\n        this.innerCircle.runAction(action);\n        this.isReleased = true;\n        \n        if(this.dynamicJoystick)\n        {\n            this.scheduleOnce( this.delayClose, 1)\n        }\n    }\n\n    delayClose()\n    {\n        this.node.active = false;\n    }\n\n    get axis()\n    {\n        if(this.isReleased) return cc.Vec2.ZERO;\n        let vec = this.innerCircle.getPosition();\n        vec.normalizeSelf()\n        return vec;\n    }\n\n    move(pos:cc.Vec2)\n    {\n        let mag = pos.mag();\n        if(mag > this.radius)\n        {\n            if(this.releaseAfterOver)\n                this.releaseStick();\n            \n            pos.normalizeSelf();\n            pos.mulSelf(this.radius)\n        }\n        this.innerCircle.setPosition(pos);\n    }\n\n    _startPos:cc.Vec2 = cc.Vec2.ZERO;\n\n    // p : screen position\n    touchStart(p)\n    {\n        if(!this.enabled) return;\n        this.isReleased = false;\n        this._startPos = p;\n        this.unschedule(this.delayClose);\n        this.node.active = true;\n        if(this.dynamicJoystick)\n        {\n            // converto screen position\n            let pos = this.node.getParent().convertToNodeSpaceAR(p);\n            this.node.setPosition(pos);\n            // this.node.opacity = 0;\n            // this.node.runAction(cc.fadeIn(0.5));\n        }\n        this.move(cc.Vec2.ZERO);\n    }\n\n    touchMove(p)\n    {\n        if(!this.enabled) return;\n        let vec = p.sub(this._startPos);\n        this.move(vec);\n    }\n\n    touchEnd(p)\n    {\n        if(!this.enabled) return;\n        // this.move(p);\n        this.releaseStick();\n    }\n}"]}